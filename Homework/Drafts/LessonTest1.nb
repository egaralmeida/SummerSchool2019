(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     13343,        333]
NotebookOptionsPosition[     11437,        291]
NotebookOutlinePosition[     11810,        307]
CellTagsIndexPosition[     11767,        304]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pulse Width Modulation in Layman\[CloseCurlyQuote]s Terms", "Title",
 CellChangeTimes->{{3.77045934807331*^9, 
  3.7704593684339585`*^9}},ExpressionUUID->"b3d0dd5b-f94d-49e2-9e2a-\
0f5ac5a2e26c"],

Cell["...or how to emulate an analog output using a digital signal", \
"Subtitle",
 CellChangeTimes->{{3.770459372514778*^9, 3.7704594538672905`*^9}, {
  3.7704606098095245`*^9, 
  3.770460624499613*^9}},ExpressionUUID->"082c908e-96b3-4fd8-9d6b-\
562f8f33b455"],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.7704600610486345`*^9, 
  3.7704600650626783`*^9}},ExpressionUUID->"4ccb8d61-9fc9-4505-9ee3-\
e1caadea6476"],

Cell[CellGroupData[{

Cell[TextData[ButtonBox["https://www.youtube.com/watch?v=YmPziPfaByw",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["https://www.youtube.com/watch?v=YmPziPfaByw"], None},
 ButtonNote->"https://www.youtube.com/watch?v=YmPziPfaByw"]], "Item",
 CellChangeTimes->{{3.770470932669216*^9, 
  3.7704709634383297`*^9}},ExpressionUUID->"628de33f-af67-4b00-9c5b-\
085ea2b4d443"],

Cell[TextData[ButtonBox["https:// www.arduino.cc/en/Tutorial/PWM",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["https:// www.arduino.cc/en/Tutorial/PWM"], None},
 ButtonNote->"https:// www.arduino.cc/en/Tutorial/PWM"]], "Item",
 CellChangeTimes->{{3.770470932669216*^9, 3.770470944029336*^9}, {
  3.77047097469773*^9, 
  3.770470974698727*^9}},ExpressionUUID->"ad56abd4-4ac7-462d-887e-\
131304b739b9"],

Cell[TextData[ButtonBox["https://learn.sparkfun.com/tutorials/pulse-width-\
modulation/all",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["https://learn.sparkfun.com/tutorials/pulse-width-modulation/all"], 
   None},
 ButtonNote->
  "https://learn.sparkfun.com/tutorials/pulse-width-modulation/all"]], "Item",
 CellChangeTimes->{{3.770470932669216*^9, 3.7704709434852095`*^9}, {
  3.7704709813146896`*^9, 
  3.7704709813146896`*^9}},ExpressionUUID->"8eca3af0-971d-4edb-bb7f-\
2f01ebcc789a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Why do I need this?", "Section",
 CellChangeTimes->{{3.770460497589246*^9, 
  3.7704605033639345`*^9}},ExpressionUUID->"589f766c-cfd7-4aa1-b70b-\
735eb32db5fa"],

Cell["\<\
Say you want to modify the speed of a motor or the brightness of an LED. One \
way to do it would be to modify the voltage applied to it: Less voltage would \
mean less speed for the motor, and less brightness for the LED since less \
current flows through it. But most Arduino boards don\[CloseCurlyQuote]t have \
a way to output varying voltages, they lack a circuit called \
\[OpenCurlyDoubleQuote]DAC\[CloseCurlyDoubleQuote] (digital to analog \
converter). This is where Pulse Width Modulation (PWM) kicks in. \
\>", "Text",
 CellChangeTimes->{{3.7704605113313513`*^9, 3.77046056642531*^9}, {
   3.7704709912832394`*^9, 3.7704711201550803`*^9}, 3.7704963622687116`*^9, {
   3.770496459181628*^9, 3.7704965594946194`*^9}, {3.7704965961959214`*^9, 
   3.770496809989354*^9}, {3.770496841698743*^9, 
   3.770496851990444*^9}},ExpressionUUID->"8617a59e-cd77-4fc2-a7e3-\
61cdbd5276bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s learn", "Section",
 CellChangeTimes->{{3.770460397250027*^9, 
  3.77046040329173*^9}},ExpressionUUID->"a0c9bc8b-31c1-4edc-86fd-\
334168606fe4"],

Cell["\<\
So far you\[CloseCurlyQuote]ve learned about the digital input and outputs of \
an Arduino (or maybe a plain, organic, 100% fat-free microcontroller). You \
know how to get data into the Arduino and out of it, but only in ones and \
zeroes. This is great, since we only need ones and zeroes for PWM. \
\>", "Text",
 CellChangeTimes->{
  3.770459493977346*^9, {3.7704596416075745`*^9, 3.770459729871831*^9}, {
   3.7704599189971075`*^9, 3.770459982217415*^9}, {3.7704604156885233`*^9, 
   3.770460442214279*^9}, {3.77049685722427*^9, 3.7704968723508596`*^9}, {
   3.7704969128950205`*^9, 3.770497004928018*^9}, {3.7704971168160357`*^9, 
   3.7704971803336086`*^9}},ExpressionUUID->"ba6e4614-b3c2-4b98-9c46-\
cb8b15f05d66"],

Cell[CellGroupData[{

Cell["Square Wave", "Subsection",
 CellChangeTimes->{{3.77049720034879*^9, 
  3.770497202760765*^9}},ExpressionUUID->"7a9c7cf7-218a-4cd1-a848-\
74d64ee21e99"],

Cell[TextData[{
 "To understand PWM better, we are first going to see it as a ",
 Cell[BoxData[
  TagBox[
   TooltipBox["\<\"waveform\"\>",
    "\"a way to see data over time\"",
    TooltipStyle->"TextStyling"],
   Annotation[#, "a way to see data over time", "Tooltip"]& ]], "Output",
  CellChangeTimes->{{3.7704990602822046`*^9, 3.7704990681455307`*^9}},
  ExpressionUUID->"99f0eb1d-3577-4401-88c1-a648f11203dc"],
 ". Flip the light switch below on an off and see what happens.\n\n{Insert \
here a thingy that draws a squarewave according to the student\
\[CloseCurlyQuote]s input on the light switch}\n\nAs you can see, "
}], "Text",
 CellChangeTimes->{{3.770497211540576*^9, 3.770497491553379*^9}, {
   3.770497609391491*^9, 3.770497658185897*^9}, {3.7704977244117465`*^9, 
   3.770497787529062*^9}, {3.7704978189035263`*^9, 3.7704978233298025`*^9}, 
   3.7704980605798173`*^9, {3.7704981181054945`*^9, 3.7704981231849504`*^9}, {
   3.7704985409757037`*^9, 3.7704986168578806`*^9}, {3.7704988574541297`*^9, 
   3.770498860664713*^9}, {3.770499016240735*^9, 3.7704990228337336`*^9}, {
   3.770499080654738*^9, 
   3.770499085247835*^9}},ExpressionUUID->"43e7b661-1581-46ae-8ddb-\
44a3e98be555"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"history", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"startTime", "=", 
    RowBox[{"UnixTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"switchHistory", "[", "time_", "]"}], ":=", 
   RowBox[{"1", "/;", 
    RowBox[{"EvenQ", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"Select", "[", 
       RowBox[{"history", ",", 
        RowBox[{
         RowBox[{"#", "<", "time"}], "&"}]}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"switchHistory", "[", "time_", "]"}], ":=", 
    RowBox[{"0", "/;", 
     RowBox[{"OddQ", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"history", ",", 
         RowBox[{
          RowBox[{"#", "<", "time"}], "&"}]}], "]"}], "]"}], "]"}]}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Button", "[", 
   RowBox[{"\"\<Switch\>\"", ",", 
    RowBox[{"history", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"history", ",", 
       RowBox[{
        RowBox[{"UnixTime", "[", "]"}], "-", "startTime"}]}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Dynamic", "[", 
  RowBox[{
   RowBox[{"Refresh", "[", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"switchHistory", "[", "time", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"time", ",", 
        RowBox[{"Max", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"UnixTime", "[", "]"}], "-", "startTime", "-", "10"}]}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{"UnixTime", "[", "]"}], "-", "startTime"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"UnixTime", "[", "]"}], "-", "startTime", "-", "10"}]}],
             "]"}], ",", 
           RowBox[{
            RowBox[{"UnixTime", "[", "]"}], "-", "startTime", "+", "1"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], "]"}], ",", 
   RowBox[{"UpdateInterval", "\[Rule]", "0.1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7705042092852106`*^9, 3.770504209292743*^9}, {
  3.7705045716512814`*^9, 3.7705046324973073`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"4572bf9c-3dfa-407d-8101-5e171c7c8b81"],

Cell[BoxData[
 ButtonBox["\<\"Switch\"\>",
  Appearance->Automatic,
  ButtonFunction:>($CellContext`history = 
   Append[$CellContext`history, UnixTime[] - $CellContext`startTime]),
  Evaluator->Automatic,
  Method->"Preemptive"]], "Output",
 CellChangeTimes->{3.7705042224045467`*^9, 3.770504597772732*^9, 
  3.770504633516655*^9, 3.770553479080931*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"cdccdd65-0aff-4ec6-bb9f-f7431deb3279"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   Refresh[
    Plot[
     $CellContext`switchHistory[$CellContext`time], {$CellContext`time, 
      Max[0, UnixTime[] - $CellContext`startTime - 10], 
      UnixTime[] - $CellContext`startTime}, PlotRange -> {{
        Max[0, UnixTime[] - $CellContext`startTime - 10], 
        UnixTime[] - $CellContext`startTime + 1}, {0, 1}}]], StandardForm],
  ImageSizeCache->{468., {144., 151.}},
  UpdateInterval->0.1]], "Output",
 CellChangeTimes->{3.7705042224045467`*^9, 3.770504597772732*^9, 
  3.770504633516655*^9, 3.770553479085827*^9},
 CellLabel->"Out[14]=",ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztW71uFDEQ9t3eT34RoUDQpUCiI+Tuwt8DQAG8AtIpAiUFAoW8wBUI3gFd
wQNQRBFXICqSgu4UCSroKCLxEot/dtf27Ph3o1xObKQ9eT2eb8cz9ozHdp4O
93eevxzu724P1x/tDV/v7G6/WX/4ao9WJQ1CGj/oc/MaoeWUEPGwv5/0EUVz
qcd+k/R0MnoxntJik7232Wv2p9Sm6XSM1MrGo8lpSu54IbbQVvALAVjtolXK
UUibkkmSVdAGgyi54Hu13sl2tJrcrYIFtN6U1ryuaoIrNC/TetZYq1bojE3Q
OTj/2hZDXHYiUgExKcFXhPZ80bpau1w48iBSItSSsT3r0KaZKnOmIDy9Har5
BrfoLfH1fF6QFhjVXJo1ThcAUjD5Ce1bWQOy6YOcyPaY3MjH4nChfhMwAkPx
VG/AGEveYKN670sWZHO6d8a4eTsxGjbysafMWFZsg1GAGgnF7dkQI+QMwlOs
nkirc/pWCM4S8P2Apx/fR2WASxtXwHPaltVKT6DYtvAl+ARkZOhBejbEpEAM
tK0nXsnzSrkGIThLUBadpx/fRz5FFSfO+1gBD7WBsO3tNIvsjKyP+St5JC95
bTj+8ojPKwZmxJaK2PK0bT8ET7Ftu7CtiG5BcmFrH40vCK0LrTuaTCcj0gQe
OLancA0n+ttU7Mtp46mumzU9tpctq7sugdr3wqP06RQCW6yL4i1a8Iji0bjn
G0TiNFE+C9qqZy/JvXhNoZoX83VTjAZWO8IjrP86a+DGysbUaDx2rK0isdAo
toVjLVqw8lmi8BhQVj17R+7H9cgSR0UOxJ272rqU+OA5kCyCFeiyE1GM8la+
9mNVtizIE29FxcN6wNiCEDUJhZcrOMNkK/e1o8fAYNlsvS0Moti57J+LDQQl
L1Yzb7VtUWnbuYCIztxe6jEWS8rFZyq+T+DC8tu5CO4daxYpkW3nghkY7k2x
dVgKtoR460XNoYE9I1ZzLPnB5OugM1Lh6eKeN1thoDT2cpRzo54JWZ8UtGrc
jJbSrh/Q51IlFJJQCFFNLoP3Nce7q32Np7+vnJmlblywnleV56z5C00Hz2qX
ph+D9ycV6Zmk3j6rDfjZzyczJghQAhNGLQzzK8e4OreUnHCRZJpPSq3JWsfV
KMYVXUvNq+FefdOOBxxjtmeR5xhkwcxt8PxyT0u8d20IaJTuSATlPQShC2Rg
MrUzgC9WzoWCU+xowDjm/rZAkLs+VgRbXEX3HSxoJmt20aTXhYRHPJBb1RGv
ptSarHV8/hRjLEwKt1k6STN7K8x3LvhzG/x49n3HaXZIbOE+23B26hffBILp
hC5EFs5ROgmKxUHPIIK0zSNUeS880N5yL9fBDeKj/2iZ/dypPcqsKbWOa01W
oxjjX0dLG7hDgmf4iR0V2z9DbuxF5zXYKXJEnuXKkgLiYRe/zRIpU2K+PWHR
vB2x0GF4Pp4hgPw02PrgXDIqewTnYPMbI2t/VGtyfij/qyY9T8DBiXpY1pDv
sOn31PAzMAUpIEKazi41tMonod5o6D1N/3irZHuFymOyxlwa7BbauendMh6w
m1AVd1wdo3P28632T7Om1JqsdVyNgv4/kfXGmNkjQSzh0XxuYuD8im913jdx
oqC+XrQ9PPpNgd59/E5S+vOeFZKTX38z5F4k6oeDE6E1Ieaz0ee39CHJt+mf
aGRWzm6/MeWCa9ohnPolYZumJWf5FituYcZxbBkR8B6NbM9K5v++JY1/541l
Aw==\
\>"],ExpressionUUID->"0e379cf3-a48e-471a-80e3-18c68f289a82"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1904, 997},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.3 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 11, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[583, 22, 201, 3, 126, "Title",ExpressionUUID->"b3d0dd5b-f94d-49e2-9e2a-0f5ac5a2e26c"],
Cell[787, 27, 261, 5, 68, "Subtitle",ExpressionUUID->"082c908e-96b3-4fd8-9d6b-562f8f33b455"],
Cell[CellGroupData[{
Cell[1073, 36, 159, 3, 84, "Section",ExpressionUUID->"4ccb8d61-9fc9-4505-9ee3-e1caadea6476"],
Cell[CellGroupData[{
Cell[1257, 43, 370, 7, 40, "Item",ExpressionUUID->"628de33f-af67-4b00-9c5b-085ea2b4d443"],
Cell[1630, 52, 404, 8, 40, "Item",ExpressionUUID->"ad56abd4-4ac7-462d-887e-131304b739b9"],
Cell[2037, 62, 492, 11, 40, "Item",ExpressionUUID->"8eca3af0-971d-4edb-bb7f-2f01ebcc789a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2578, 79, 166, 3, 84, "Section",ExpressionUUID->"589f766c-cfd7-4aa1-b70b-735eb32db5fa"],
Cell[2747, 84, 895, 14, 102, "Text",ExpressionUUID->"8617a59e-cd77-4fc2-a7e3-61cdbd5276bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3679, 103, 172, 3, 84, "Section",ExpressionUUID->"a0c9bc8b-31c1-4edc-86fd-334168606fe4"],
Cell[3854, 108, 731, 12, 73, "Text",ExpressionUUID->"ba6e4614-b3c2-4b98-9c46-cb8b15f05d66"],
Cell[CellGroupData[{
Cell[4610, 124, 158, 3, 69, "Subsection",ExpressionUUID->"7a9c7cf7-218a-4cd1-a848-74d64ee21e99"],
Cell[4771, 129, 1198, 22, 160, "Text",ExpressionUUID->"43e7b661-1581-46ae-8ddb-44a3e98be555"],
Cell[CellGroupData[{
Cell[5994, 155, 2474, 73, 263, "Input",ExpressionUUID->"4572bf9c-3dfa-407d-8101-5e171c7c8b81"],
Cell[8471, 230, 433, 9, 58, "Output",ExpressionUUID->"cdccdd65-0aff-4ec6-bb9f-f7431deb3279"],
Cell[8907, 241, 2478, 44, 318, 456, 10, "CachedBoxData", "BoxData", "Output",ExpressionUUID->"0e379cf3-a48e-471a-80e3-18c68f289a82"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

